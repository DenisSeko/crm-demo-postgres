import{e as he,r as $,m as ye,o as v,c as b,a as e,w as F,F as H,t as f,u as Q,b as J,d as N,f as W,n as B,g as se,h as O,i as de,j as Z,k as X,l as D,p as L,v as E,q as K,s as ke,x as we,y as je,z as ie,A as _e,T as $e,B as Ne,C as Ae,D as Pe}from"./vendor-d89fa7ba.js";import{a as Te}from"./utils-edfcd65b.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const u of g.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function l(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(d){if(d.ep)return;d.ep=!0;const g=l(d);fetch(d.href,g)}})();var ze=!1;/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const Se=Symbol();var le;(function(s){s.direct="direct",s.patchObject="patch object",s.patchFunction="patch function"})(le||(le={}));function Ce(){const s=he(!0),i=s.run(()=>$({}));let l=[],o=[];const d=ye({install(g){d._a=g,g.provide(Se,d),g.config.globalProperties.$pinia=d,o.forEach(u=>l.push(u)),o=[]},use(g){return!this._a&&!ze?o.push(g):l.push(g),this},_p:l,_a:null,_e:s,_s:new Map,state:i});return d}const Re=()=>typeof window>"u"?{baseURL:"http://localhost:8888/api",timeout:1e4}:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?{baseURL:"http://localhost:8888/api",timeout:1e4}:{baseURL:"/api",timeout:15e3},z=Te.create(Re()),C={setAuth(s,i){try{localStorage.setItem("authToken",s),localStorage.setItem("user",JSON.stringify(i)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("authTimestamp",Date.now().toString()),console.log("ğŸ” Auth podaci spremljeni:",{token:s?`${s.substring(0,20)}...`:"empty",user:{id:i==null?void 0:i.id,email:i==null?void 0:i.email,role:i==null?void 0:i.role}}),z.defaults.headers.common.Authorization=`Bearer ${s}`}catch(l){console.error("âŒ GreÅ¡ka pri spremanju auth podataka:",l)}},clearAuth(){try{localStorage.removeItem("authToken"),localStorage.removeItem("user"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("authTimestamp"),delete z.defaults.headers.common.Authorization,console.log("ğŸ” Auth podaci oÄiÅ¡Ä‡eni")}catch(s){console.error("âŒ GreÅ¡ka pri ÄiÅ¡Ä‡enju auth podataka:",s)}},getToken(){try{return localStorage.getItem("authToken")}catch(s){return console.error("âŒ GreÅ¡ka pri dobivanju tokena:",s),null}},getUser(){try{const s=localStorage.getItem("user");return s?JSON.parse(s):null}catch(s){return console.error("âŒ GreÅ¡ka pri dobivanju korisnika:",s),null}},isAuthenticated(){try{const s=this.getToken(),i=this.getUser(),l=localStorage.getItem("isAuthenticated")==="true",o=!!(s&&i&&l&&!this.isTokenExpired());return console.log("ğŸ” Auth status:",{authenticated:o,hasToken:!!s,hasUser:!!i,isExpired:this.isTokenExpired()}),o}catch(s){return console.error("âŒ GreÅ¡ka pri provjeri autentikacije:",s),!1}},isTokenExpired(){const s=this.getToken();if(!s)return console.log("âš ï¸ Nema tokena za provjeru"),!0;try{const i=JSON.parse(atob(s.split(".")[1])),l=i.exp*1e3<Date.now();return l?(console.log("âš ï¸ Token je istekao:",new Date(i.exp*1e3).toLocaleString("hr-HR")),this.clearAuth()):console.log("âœ… Token je validan do:",new Date(i.exp*1e3).toLocaleString("hr-HR")),l}catch(i){return console.error("âŒ GreÅ¡ka pri provjeri tokena:",i),this.clearAuth(),!0}},initializeAuth(){try{const s=this.getToken();return s&&!this.isTokenExpired()?(z.defaults.headers.common.Authorization=`Bearer ${s}`,console.log("ğŸ” Auth inicijaliziran iz localStorage"),!0):(console.log("ğŸ” Nema validnog tokena za inicijalizaciju"),this.clearAuth(),!1)}catch(s){return console.error("âŒ GreÅ¡ka pri inicijalizaciji auth:",s),this.clearAuth(),!1}},getAuthInfo(){return{hasToken:!!this.getToken(),hasUser:!!this.getUser(),isAuthenticated:this.isAuthenticated(),isTokenExpired:this.isTokenExpired(),user:this.getUser(),tokenPreview:this.getToken()?`${this.getToken().substring(0,20)}...`:null}}};z.interceptors.request.use(s=>{var l,o,d;const i=C.getToken();return i&&!C.isTokenExpired()?(s.headers.Authorization=`Bearer ${i}`,console.log(`ğŸš€ ${(l=s.method)==null?void 0:l.toUpperCase()} ${s.url} [AUTH]`)):(console.log(`ğŸš€ ${(o=s.method)==null?void 0:o.toUpperCase()} ${s.url} [NO AUTH]`),i&&C.isTokenExpired()&&C.clearAuth()),console.log(`ğŸ“¤ Request: ${(d=s.method)==null?void 0:d.toUpperCase()} ${s.url}`,{hasData:!!s.data,hasParams:!!s.params}),s},s=>(console.error("âŒ Request error:",s),Promise.reject({...s,userMessage:"Problem s mreÅ¾nom vezom. Provjerite internetsku vezu."})));z.interceptors.response.use(s=>{var i;return console.log(`âœ… ${(i=s.config.method)==null?void 0:i.toUpperCase()} ${s.config.url}: ${s.status}`),s},s=>{var x,p,r,w,c,h,S,T,R;const i=(x=s.config)==null?void 0:x.url,l=(p=s.config)==null?void 0:p.method,o=(r=s.response)==null?void 0:r.status,d=((c=(w=s.response)==null?void 0:w.data)==null?void 0:c.error)||s.message,g=(S=(h=s.response)==null?void 0:h.data)==null?void 0:S.code;if(console.error(`âŒ API Error ${o} [${l==null?void 0:l.toUpperCase()} ${i}]:`,{message:d,code:g,userMessage:((R=(T=s.response)==null?void 0:T.data)==null?void 0:R.error)||"DoÅ¡lo je do greÅ¡ke"}),o===401&&(console.log("ğŸ” 401 Unauthorized - clearing auth"),C.clearAuth(),typeof window<"u")){const A=window.location.pathname+window.location.search;!A.includes("login")&&!A.includes("auth=login")&&(console.log("ğŸ”„ Redirecting to login..."),setTimeout(()=>{window.location.href="/?auth=login&message=session_expired"},1500))}(s.code==="NETWORK_ERROR"||s.message==="Network Error")&&console.error("ğŸŒ Network Error - provjeri internet konekciju ili server status");let u="DoÅ¡lo je do greÅ¡ke. PokuÅ¡ajte ponovno.";return s.response?o>=500?u="Server trenutno nije dostupan. PokuÅ¡ajte ponovno kasnije.":o===404?u="TraÅ¾eni resurs nije pronaÄ‘en.":o===403?u="Nemate dovoljne privilegije za ovu akciju.":d&&(u=d):u="Problem s mreÅ¾nom vezom. Provjerite internetsku vezu.",Promise.reject({...s,userMessage:u,errorCode:g,originalMessage:d,isNetworkError:!s.response,isServerError:o>=500,isClientError:o>=400&&o<500})});const Ue={async safeGet(s,i={}){try{return(await z.get(s,i)).data}catch(l){throw console.error(`âŒ Safe GET error for ${s}:`,l.userMessage||l.message),l}},async safePost(s,i={},l={}){try{return(await z.post(s,i,l)).data}catch(o){throw console.error(`âŒ Safe POST error for ${s}:`,o.userMessage||o.message),o}},async healthCheck(){try{const s=await z.get("/health");return{status:s.status===200,data:s.data,timestamp:new Date().toISOString()}}catch(s){return console.error("âŒ Health check failed:",s.message),{status:!1,error:s.message,timestamp:new Date().toISOString()}}},async testConnection(){try{const s=Date.now(),i=await z.get("/");return{success:!0,responseTime:Date.now()-s,data:i.data,status:i.status}}catch(s){return{success:!1,error:s.message,userMessage:s.userMessage}}}};typeof window<"u"&&setTimeout(()=>{const s=C.initializeAuth();console.log("ğŸ”„ Auth initialization result:",s),(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&setTimeout(async()=>{try{const i=await Ue.testConnection();console.log("ğŸŒ Initial connection test:",i)}catch(i){console.warn("âš ï¸ Initial connection test failed:",i.message)}},2e3)},100);const q=(s,i)=>{const l=s.__vccOpts||s;for(const[o,d]of i)l[o]=d;return l},Le={class:"bg-white shadow-sm border-b"},Ee={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Me={class:"flex justify-between items-center h-16"},De={class:"flex items-center"},Oe={class:"flex items-center space-x-4"},Ve={class:"flex items-center space-x-3 bg-gray-50 rounded-lg px-3 py-2"},Ie={class:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold text-sm"},Ge={class:"hidden md:block"},Fe={class:"text-sm font-medium text-gray-700"},He={class:"text-xs text-gray-500 capitalize"},qe={__name:"AppHeader",props:{user:{type:Object,default:null}},emits:["go-home","logout"],setup(s){const i=l=>{var g,u,x,p;if(!l)return"?";const o=((g=l.firstName)==null?void 0:g.charAt(0))||"",d=((u=l.lastName)==null?void 0:u.charAt(0))||"";return(o+d).toUpperCase()||((p=(x=l.username)==null?void 0:x.charAt(0))==null?void 0:p.toUpperCase())||"U"};return(l,o)=>(v(),b("nav",Le,[e("div",Ee,[e("div",Me,[e("div",De,[e("a",{href:"#",onClick:o[0]||(o[0]=F(d=>l.$emit("go-home"),["prevent"])),class:"flex items-center space-x-3 text-gray-800 hover:text-blue-600 transition-colors duration-200"},[...o[3]||(o[3]=[e("div",{class:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center"},[e("span",{class:"text-white font-bold text-sm"},"CRM")],-1),e("h1",{class:"text-xl font-semibold hidden sm:block"}," CRM Sustav ",-1)])])]),e("div",Oe,[s.user?(v(),b(H,{key:0},[e("div",Ve,[e("div",Ie,f(i(s.user)),1),e("div",Ge,[e("div",Fe,f(s.user.firstName)+" "+f(s.user.lastName),1),e("div",He,f(s.user.role),1)])]),e("button",{onClick:o[1]||(o[1]=d=>l.$emit("logout")),class:"text-gray-600 hover:text-red-600 px-3 py-2 rounded-md text-sm font-medium flex items-center gap-2 transition-colors duration-200 hover:bg-red-50 border border-transparent hover:border-red-200"},[...o[4]||(o[4]=[e("span",{class:"text-lg"},"ğŸšª",-1),e("span",{class:"hidden sm:inline"},"Odjava",-1)])])],64)):(v(),b(H,{key:1},[o[6]||(o[6]=e("div",{class:"flex items-center space-x-2 text-sm text-gray-500"},[e("div",{class:"w-2 h-2 bg-gray-400 rounded-full animate-pulse"}),e("span",{class:"hidden sm:inline"},"Niste prijavljeni")],-1)),e("button",{onClick:o[2]||(o[2]=d=>l.$emit("go-home")),class:"text-blue-600 hover:text-blue-800 px-3 py-2 rounded-md text-sm font-medium flex items-center gap-2 transition-colors duration-200 hover:bg-blue-50"},[...o[5]||(o[5]=[e("span",{class:"text-lg"},"ğŸ ",-1),e("span",{class:"hidden sm:inline"},"PoÄetna",-1)])])],64))])])])]))}},Ke=q(qe,[["__scopeId","data-v-945f2c76"]]);const Be={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-100 flex items-center justify-center p-4"},Je={class:"max-w-6xl mx-auto w-full"},We={class:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-2xl border border-yellow-200 p-8 max-w-4xl mx-auto"},Ze={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Qe={class:"flex items-center justify-between mb-2"},Xe={class:"font-semibold text-gray-800 text-sm"},Ye={class:"text-xs text-gray-600 font-mono mb-3"},et=["onClick"],tt={__name:"HomePage",emits:["go-to-login","go-to-register","use-demo-account"],setup(s,{emit:i}){const l=Q(),o=i,d=$([{name:"Admin",email:"admin@crm.com",password:"password123",role:"admin"},{name:"Ivan Horvat",email:"ivan.horvat@primjer.hr",password:"password123",role:"user"},{name:"Ana KovaÄ",email:"ana.kovac@primjer.hr",password:"password123",role:"user"},{name:"Marko Petrov",email:"marko.petrov@primjer.hr",password:"password123",role:"user"}]),g=()=>{console.log("ğŸ”„ Redirect na login..."),l.push("/login")},u=()=>{console.log("ğŸ”„ Redirect na registraciju..."),l.push("/register")},x=p=>{console.log(`ğŸ” Koristim demo raÄun: ${p.email}`),o("use-demo-account",p),l.push({path:"/login",query:{email:p.email,password:p.password,demo:"true"}})};return(p,r)=>(v(),b("div",Be,[e("div",Je,[r[6]||(r[6]=J('<div class="text-center mb-16" data-v-7344699b><div class="mb-6" data-v-7344699b><div class="inline-flex items-center justify-center w-20 h-20 bg-blue-600 rounded-2xl shadow-lg mb-4" data-v-7344699b><span class="text-3xl text-white" data-v-7344699b>ğŸš€</span></div></div><h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-6" data-v-7344699b> Moderni <span class="text-blue-600" data-v-7344699b>CRM</span> Sustav </h1><p class="text-xl md:text-2xl text-gray-600 max-w-3xl mx-auto leading-relaxed" data-v-7344699b> Upravljajte svojim klijentima, biljeÅ¡kama i poslovanjem na jednom mjestu </p></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16" data-v-7344699b><div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1" data-v-7344699b><div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4" data-v-7344699b><span class="text-xl text-blue-600" data-v-7344699b>ğŸ‘¥</span></div><h3 class="text-lg font-semibold text-gray-800 mb-2" data-v-7344699b>Upravljanje Klijentima</h3><p class="text-gray-600 text-sm leading-relaxed" data-v-7344699b> Organizirajte sve vaÅ¡e klijente, kontakt podatke i povijest suradnje na jednom mjestu </p></div><div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1" data-v-7344699b><div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4" data-v-7344699b><span class="text-xl text-green-600" data-v-7344699b>ğŸ“</span></div><h3 class="text-lg font-semibold text-gray-800 mb-2" data-v-7344699b>BiljeÅ¡ke i Aktivnosti</h3><p class="text-gray-600 text-sm leading-relaxed" data-v-7344699b> Pratite sve razgovore, sastanke i vaÅ¾ne dogaÄ‘aje s detaljnim biljeÅ¡kama </p></div><div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1" data-v-7344699b><div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4" data-v-7344699b><span class="text-xl text-purple-600" data-v-7344699b>ğŸ“Š</span></div><h3 class="text-lg font-semibold text-gray-800 mb-2" data-v-7344699b>Analitika i IzvjeÅ¡taji</h3><p class="text-gray-600 text-sm leading-relaxed" data-v-7344699b> Dobijte uvid u performance kroz detaljne statistike i grafikone </p></div><div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1" data-v-7344699b><div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mb-4" data-v-7344699b><span class="text-xl text-orange-600" data-v-7344699b>ğŸ”’</span></div><h3 class="text-lg font-semibold text-gray-800 mb-2" data-v-7344699b>Sigurnost Podataka</h3><p class="text-gray-600 text-sm leading-relaxed" data-v-7344699b> JWT autentikacija i sigurna PostgreSQL baza podataka za zaÅ¡titu vaÅ¡ih podataka </p></div></div>',2)),e("div",{class:"text-center mb-16"},[e("div",{class:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8 max-w-2xl mx-auto"},[r[2]||(r[2]=e("h2",{class:"text-2xl md:text-3xl font-bold text-gray-800 mb-4"}," Spremni za poÄetak? ",-1)),r[3]||(r[3]=e("p",{class:"text-gray-600 mb-8 max-w-xl mx-auto"}," PridruÅ¾ite se tisuÄ‡ama zadovoljnih korisnika koji veÄ‡ upravljaju svojim poslovanjem putem naÅ¡eg CRM sustava ",-1)),e("div",{class:"flex flex-col sm:flex-row gap-4 justify-center items-center"},[e("button",{onClick:g,class:"group bg-blue-600 text-white px-8 py-4 rounded-xl hover:bg-blue-700 transition-all duration-200 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-3 min-w-[200px] justify-center"},[...r[0]||(r[0]=[e("span",{class:"group-hover:scale-110 transition-transform"},"ğŸ”",-1),N(" Prijavi se ",-1)])]),e("button",{onClick:u,class:"group bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-4 rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-200 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-3 min-w-[200px] justify-center"},[...r[1]||(r[1]=[e("span",{class:"group-hover:scale-110 transition-transform"},"ğŸ‘¤",-1),N(" Registriraj se ",-1)])])])])]),e("div",We,[r[5]||(r[5]=J('<div class="text-center mb-6" data-v-7344699b><div class="inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-full mb-4" data-v-7344699b><span class="text-2xl text-yellow-600" data-v-7344699b>ğŸ¯</span></div><h3 class="text-2xl font-bold text-yellow-800 mb-2" data-v-7344699b>Å½elite prvo isprobati?</h3><p class="text-yellow-700" data-v-7344699b> Koristite demo raÄune za testiranje svih funkcionalnosti. Svi korisnici koriste lozinku: <span class="font-mono font-bold bg-yellow-200 px-2 py-1 rounded" data-v-7344699b>password123</span></p></div>',1)),e("div",Ze,[(v(!0),b(H,null,W(d.value,w=>(v(),b("div",{key:w.email,class:"bg-white rounded-lg p-4 border border-yellow-100 hover:border-yellow-300 transition-colors duration-200"},[e("div",Qe,[e("span",Xe,f(w.name),1),e("span",{class:B(["px-2 py-1 text-xs rounded-full",w.role==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"])},f(w.role),3)]),e("div",Ye,f(w.email),1),e("button",{onClick:c=>x(w),class:"w-full bg-yellow-500 text-white py-2 px-3 rounded-lg hover:bg-yellow-600 transition-colors duration-200 text-sm font-medium flex items-center justify-center gap-2"},[...r[4]||(r[4]=[e("span",null,"âš¡",-1),N(" Koristi raÄun ",-1)])],8,et)]))),128))])]),r[7]||(r[7]=J('<div class="text-center mt-16" data-v-7344699b><p class="text-gray-500 text-sm mb-4" data-v-7344699b>Powered by modern tech stack</p><div class="flex flex-wrap justify-center gap-6 opacity-75" data-v-7344699b><div class="flex items-center gap-2 text-gray-600" data-v-7344699b><span data-v-7344699b>âš¡</span><span class="font-mono text-sm" data-v-7344699b>Vue 3</span></div><div class="flex items-center gap-2 text-gray-600" data-v-7344699b><span data-v-7344699b>ğŸ”·</span><span class="font-mono text-sm" data-v-7344699b>Node.js</span></div><div class="flex items-center gap-2 text-gray-600" data-v-7344699b><span data-v-7344699b>ğŸ˜</span><span class="font-mono text-sm" data-v-7344699b>PostgreSQL</span></div><div class="flex items-center gap-2 text-gray-600" data-v-7344699b><span data-v-7344699b>ğŸ”</span><span class="font-mono text-sm" data-v-7344699b>JWT Auth</span></div><div class="flex items-center gap-2 text-gray-600" data-v-7344699b><span data-v-7344699b>ğŸ¨</span><span class="font-mono text-sm" data-v-7344699b>Tailwind CSS</span></div></div></div>',1))])]))}},ue=q(tt,[["__scopeId","data-v-7344699b"]]);const st={class:"max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-md border border-gray-200"},ot={class:"flex items-center"},at={class:"mr-2 text-lg"},rt={class:"font-medium"},nt={key:0,class:"text-red-500 text-xs mt-1 flex items-center"},it={key:0,class:"text-red-500 text-xs mt-1 flex items-center"},lt=["disabled"],dt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},ut={key:1,class:"mr-2"},ct={class:"mt-6 p-4 bg-blue-50 rounded-md border border-blue-200"},mt={class:"space-y-2 text-sm"},pt={class:"font-medium text-gray-800"},gt={class:"text-xs text-gray-600"},vt={class:"text-xs text-gray-500"},bt=["onClick"],ft={class:"mt-6 text-center space-y-3"},xt={class:"text-sm text-gray-600"},ht={class:"pt-2 border-t border-gray-200"},yt={__name:"LoginForm",emits:["login","show-register","go-home"],setup(s,{expose:i,emit:l}){Q();const o=se(),d=l,g=$(!1),u=$(""),x=$(""),p=O({email:"",password:""}),r=O({email:"admin@crm.com",password:"password123"}),w=[{name:"Admin",email:"admin@crm.com",password:"password123",role:"admin"},{name:"Ivan Horvat",email:"ivan.horvat@primjer.hr",password:"password123",role:"user"},{name:"Ana KovaÄ",email:"ana.kovac@primjer.hr",password:"password123",role:"user"},{name:"Marko Petrov",email:"marko.petrov@primjer.hr",password:"password123",role:"user"}],c=de(()=>r.email.trim()&&r.password.trim()&&r.password.length>=1),h=(y,m)=>{u.value=y,x.value=m,setTimeout(()=>{u.value="",x.value=""},5e3)},S=y=>{p[y]&&(p[y]="")},T=(y,m)=>{r.email=y,r.password=m,h(`Podaci za ${y} su uneseni!`,"success")},R=()=>{let y=!0;return Object.keys(p).forEach(m=>p[m]=""),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(p.email="Email nije ispravan",y=!1):(p.email="Email je obavezan",y=!1),r.password.trim()?r.password.length<6&&(p.password="Lozinka mora imati najmanje 6 znakova",y=!1):(p.password="Lozinka je obavezna",y=!1),y},A=()=>{o.query.email&&o.query.password&&(r.email=o.query.email,r.password=o.query.password,o.query.demo==="true"&&(h(`Demo podaci za ${r.email} su automatski uneseni!`,"success"),setTimeout(()=>{console.log("ğŸ”„ Auto-login za demo korisnika..."),P()},1500)))},P=async()=>{var y,m,j,I;if(R()){C.isTokenExpired()&&C.clearAuth(),g.value=!0,u.value="";try{console.log("ğŸ” LoginForm: PokreÄ‡em prijavu za:",r.email);const U=await z.post("/auth/login",r),{token:M,user:V}=U.data;console.log("ğŸ“¦ LoginForm: Podaci za spremanje:",{token:M,user:V}),C.setAuth(M,V),console.log("âœ… LoginForm: Auth podaci spremljeni:"),console.log("   - Token:",!!C.getToken()),console.log("   - User:",!!C.getUser()),console.log("   - isAuthenticated:",C.isAuthenticated()),h(`UspjeÅ¡no ste prijavljeni! DobrodoÅ¡li, ${V.firstName} ${V.lastName}`,"success"),console.log("âœ… LoginForm: Prijava uspjeÅ¡na, emitiram podatke..."),d("login",{token:M,user:V})}catch(U){console.error("âŒ LoginForm: GreÅ¡ka pri prijavi:",U);let M="DoÅ¡lo je do greÅ¡ke pri prijavi. PokuÅ¡ajte ponovno.";(m=(y=U.response)==null?void 0:y.data)!=null&&m.error?M=U.response.data.error:U.code==="NETWORK_ERROR"||!U.response?M="Problem s mreÅ¾nom vezom. Provjerite internetsku vezu.":((j=U.response)==null?void 0:j.status)>=500?M="Server trenutno nije dostupan. PokuÅ¡ajte ponovno kasnije.":((I=U.response)==null?void 0:I.status)===401&&(M="PogreÅ¡an email ili lozinka.",p.password="PogreÅ¡na lozinka"),h(M,"error")}finally{g.value=!1}}};return Z(()=>o.query,y=>{y.email&&y.password&&(console.log("ğŸ”„ Query parametri promijenjeni, auto-populate..."),A())}),X(()=>{console.log("ğŸš€ LoginForm mounted, provjeram query parametre..."),A()}),i({showError:y=>{h(y,"error")},clearForm:()=>{r.email="",r.password="",u.value="",x.value="",Object.keys(p).forEach(y=>p[y]="")},setCredentials:(y,m)=>{r.email=y,r.password=m,h(`Podaci za ${y} su postavljeni!`,"success")}}),(y,m)=>(v(),b("div",st,[m[13]||(m[13]=e("h2",{class:"text-2xl font-bold mb-6 text-center text-gray-800"},"Prijava",-1)),u.value?(v(),b("div",{key:0,class:B(["mb-4 p-3 rounded-md text-sm border transition-all duration-300",x.value==="error"?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"])},[e("div",ot,[e("span",at,f(x.value==="error"?"âŒ":"âœ…"),1),e("span",rt,f(u.value),1)])],2)):D("",!0),e("form",{onSubmit:F(P,["prevent"]),class:"space-y-4"},[e("div",null,[m[7]||(m[7]=e("label",{for:"loginEmail",class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),L(e("input",{id:"loginEmail",name:"email","onUpdate:modelValue":m[0]||(m[0]=j=>r.email=j),type:"email",placeholder:"Unesite svoj email",autocomplete:"email",class:B(["mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-300 ring-1 ring-red-300":p.email}]),required:"",onInput:m[1]||(m[1]=j=>S("email"))},null,34),[[E,r.email]]),p.email?(v(),b("p",nt,[m[6]||(m[6]=e("span",{class:"mr-1"},"âš ï¸",-1)),N(f(p.email),1)])):D("",!0)]),e("div",null,[m[9]||(m[9]=e("label",{for:"loginPassword",class:"block text-sm font-medium text-gray-700 mb-1"},"Lozinka",-1)),L(e("input",{id:"loginPassword",name:"password","onUpdate:modelValue":m[2]||(m[2]=j=>r.password=j),type:"password",placeholder:"Unesite lozinku",autocomplete:"current-password",class:B(["mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",{"border-red-300 ring-1 ring-red-300":p.password}]),required:"",onInput:m[3]||(m[3]=j=>S("password"))},null,34),[[E,r.password]]),p.password?(v(),b("p",it,[m[8]||(m[8]=e("span",{class:"mr-1"},"âš ï¸",-1)),N(f(p.password),1)])):D("",!0)]),e("button",{type:"submit",class:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center shadow-sm hover:shadow-md",disabled:g.value||!c.value},[g.value?(v(),b("span",dt)):(v(),b("span",ut,"ğŸ”")),N(" "+f(g.value?"Prijavljujem...":"Prijavi se"),1)],8,lt)],32),e("div",ct,[m[10]||(m[10]=e("h3",{class:"font-semibold text-blue-800 mb-3 flex items-center"},[e("span",{class:"mr-2"},"ğŸ‘¥"),N(" Demo korisnici ")],-1)),e("div",mt,[(v(),b(H,null,W(w,j=>e("div",{key:j.email,class:"flex justify-between items-center p-2 bg-white rounded border border-blue-100 hover:border-blue-300 transition-colors duration-200"},[e("div",null,[e("span",pt,f(j.name),1),e("div",gt,f(j.email),1),e("div",vt,"Lozinka: "+f(j.password),1)]),e("button",{onClick:I=>T(j.email,j.password),class:"text-blue-600 hover:text-blue-800 text-xs font-medium px-2 py-1 border border-blue-200 rounded hover:bg-blue-50 transition-all duration-200",type:"button"}," Koristi ",8,bt)])),64))])]),e("div",ft,[e("p",xt,[m[11]||(m[11]=N(" Nemate raÄun? ",-1)),e("a",{href:"#",onClick:m[4]||(m[4]=F(j=>y.$emit("show-register"),["prevent"])),class:"text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200",role:"button"}," Registrirajte se ovdje ")]),e("div",ht,[e("a",{href:"#",onClick:m[5]||(m[5]=F(j=>y.$emit("go-home"),["prevent"])),class:"text-gray-600 hover:text-gray-800 text-sm transition-colors duration-200 inline-flex items-center",role:"button"},[...m[12]||(m[12]=[e("span",{class:"mr-1"},"â†",-1),N(" Povratak na poÄetnu stranicu ",-1)])])])])]))}},kt=q(yt,[["__scopeId","data-v-63c0ac60"]]);const wt={class:"max-w-md mx-auto mt-10 p-6 bg-white rounded-lg shadow-md"},jt={class:"grid grid-cols-2 gap-4"},_t=["disabled"],$t={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Nt={class:"mt-4 text-center space-y-2"},At={class:"text-sm text-gray-600"},Pt={__name:"Registration",emits:["show-login","go-home","registered"],setup(s,{emit:i}){const l=i,o=$(!1),d=$(""),g=$(""),u=O({firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:""}),x=de(()=>u.firstName.trim()&&u.lastName.trim()&&u.username.trim()&&u.email.trim()&&u.password.length>=6&&u.password===u.confirmPassword),p=(w,c)=>{d.value=w,g.value=c,setTimeout(()=>{d.value="",g.value=""},5e3)},r=async()=>{var w,c,h,S;if(!x.value){p("Molimo ispunite sva polja ispravno.","error");return}if(u.password!==u.confirmPassword){p("Lozinke se ne podudaraju.","error");return}o.value=!0,d.value="";try{const T=await z.post("/auth/register",{firstName:u.firstName,lastName:u.lastName,username:u.username,email:u.email,password:u.password});p("UspjeÅ¡no ste registrirani! MoÅ¾ete se prijaviti.","success"),Object.assign(u,{firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:""}),l("registered",T.data),setTimeout(()=>{l("show-login")},2e3)}catch(T){console.error("Registration error:",T);const R=((c=(w=T.response)==null?void 0:w.data)==null?void 0:c.error)||((S=(h=T.response)==null?void 0:h.data)==null?void 0:S.message)||"DoÅ¡lo je do greÅ¡ke pri registraciji. PokuÅ¡ajte ponovno.";p(R,"error")}finally{o.value=!1}};return(w,c)=>(v(),b("div",wt,[c[17]||(c[17]=e("h2",{class:"text-2xl font-bold mb-6 text-center"},"Registracija",-1)),d.value?(v(),b("div",{key:0,class:B(["mb-4 p-3 rounded-md text-sm",g.value==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"])},f(d.value),3)):D("",!0),e("form",{onSubmit:F(r,["prevent"]),class:"space-y-4"},[e("div",jt,[e("div",null,[c[8]||(c[8]=e("label",{for:"firstName",class:"block text-sm font-medium text-gray-700"},"Ime *",-1)),L(e("input",{id:"firstName",name:"firstName","onUpdate:modelValue":c[0]||(c[0]=h=>u.firstName=h),type:"text",autocomplete:"given-name",class:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[E,u.firstName]])]),e("div",null,[c[9]||(c[9]=e("label",{for:"lastName",class:"block text-sm font-medium text-gray-700"},"Prezime *",-1)),L(e("input",{id:"lastName",name:"lastName","onUpdate:modelValue":c[1]||(c[1]=h=>u.lastName=h),type:"text",autocomplete:"family-name",class:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[E,u.lastName]])])]),e("div",null,[c[10]||(c[10]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"KorisniÄko ime *",-1)),L(e("input",{id:"username",name:"username","onUpdate:modelValue":c[2]||(c[2]=h=>u.username=h),type:"text",autocomplete:"username",class:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[E,u.username]]),c[11]||(c[11]=e("p",{class:"text-xs text-gray-500 mt-1"},"KorisniÄko ime mora biti jedinstveno",-1))]),e("div",null,[c[12]||(c[12]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email *",-1)),L(e("input",{id:"email",name:"email","onUpdate:modelValue":c[3]||(c[3]=h=>u.email=h),type:"email",autocomplete:"email",class:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[E,u.email]])]),e("div",null,[c[13]||(c[13]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Lozinka *",-1)),L(e("input",{id:"password",name:"password","onUpdate:modelValue":c[4]||(c[4]=h=>u.password=h),type:"password",autocomplete:"new-password",class:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:"",minlength:"6"},null,512),[[E,u.password]]),c[14]||(c[14]=e("p",{class:"text-xs text-gray-500 mt-1"},"Lozinka mora imati najmanje 6 znakova",-1))]),e("div",null,[c[15]||(c[15]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700"},"Potvrdi lozinku *",-1)),L(e("input",{id:"confirmPassword",name:"confirmPassword","onUpdate:modelValue":c[5]||(c[5]=h=>u.confirmPassword=h),type:"password",autocomplete:"new-password",class:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[E,u.confirmPassword]])]),e("button",{type:"submit",class:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center justify-center transition-all duration-200",disabled:o.value||!x.value},[o.value?(v(),b("span",$t)):D("",!0),N(" "+f(o.value?"Registriram...":"Registriraj se"),1)],8,_t)],32),c[18]||(c[18]=J('<div class="mt-6 p-4 bg-blue-50 rounded-md text-sm" data-v-94483bcb><h3 class="font-semibold mb-2" data-v-94483bcb>ğŸ“‹ Demo korisnici (veÄ‡ postoje u sustavu):</h3><div class="space-y-1 text-xs" data-v-94483bcb><div data-v-94483bcb><strong data-v-94483bcb>Admin:</strong> admin@crm.com / password123</div><div data-v-94483bcb><strong data-v-94483bcb>Ivan Horvat:</strong> ivan.horvat@primjer.hr / password123</div><div data-v-94483bcb><strong data-v-94483bcb>Ana KovaÄ:</strong> ana.kovac@primjer.hr / password123</div><div data-v-94483bcb><strong data-v-94483bcb>Marko Petrov:</strong> marko.petrov@primjer.hr / password123</div></div></div>',1)),e("div",Nt,[e("p",At,[c[16]||(c[16]=N(" VeÄ‡ imate raÄun? ",-1)),e("a",{href:"#",onClick:c[6]||(c[6]=F(h=>w.$emit("show-login"),["prevent"])),class:"text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200"}," Prijavite se ovdje ")]),e("a",{href:"#",onClick:c[7]||(c[7]=F(h=>w.$emit("go-home"),["prevent"])),class:"text-blue-600 hover:text-blue-800 text-sm block transition-colors duration-200"}," â† Povratak na poÄetnu ")])]))}},Tt=q(Pt,[["__scopeId","data-v-94483bcb"]]);const zt={__name:"AuthManager",props:{initialView:{type:String,default:"login",validator:s=>["login","register"].includes(s)}},emits:["success","go-home"],setup(s,{expose:i,emit:l}){const o=Q(),d=se(),g=s,u=l,x=$(g.initialView),p=$(!1),r=$(null);console.log("ğŸš€ AuthManager mounted sa initialView:",g.initialView),console.log("ğŸ“ Trenutna ruta:",d.path);const w=()=>{console.log("ğŸ”„ Prebacujem na login..."),x.value="login",o.push("/login")},c=()=>{console.log("ğŸ”„ Prebacujem na register..."),x.value="register",o.push("/register")},h=()=>{o.push("/")},S=async A=>{p.value=!0;try{console.log("ğŸ”„ AuthManager: Primljeni login podaci:",A),await new Promise(P=>setTimeout(P,800)),console.log("âœ… AuthManager: ProsljeÄ‘ujem podatke parent komponenti"),u("success",A)}catch(P){console.error("âŒ AuthManager: GreÅ¡ka pri prijavi:",P),r.value&&r.value.showError?r.value.showError(P.message||"DoÅ¡lo je do greÅ¡ke pri prijavi. PokuÅ¡ajte ponovno."):console.error("âŒ LoginRef nije dostupan za prikaz greÅ¡ke")}finally{p.value=!1}},T=async A=>{console.log("âœ… AuthManager: User registered:",A),p.value=!0;try{await new Promise(P=>setTimeout(P,1e3)),w()}finally{p.value=!1}},R=()=>{console.log("ğŸ”§ Force view check:"),console.log("   - Route path:",d.path),console.log("   - Current view:",x.value),d.path==="/register"?x.value!=="register"&&(console.log("ğŸ’¥ FORCE: Setting to register view"),x.value="register"):d.path==="/login"?x.value!=="login"&&(console.log("ğŸ’¥ FORCE: Setting to login view"),x.value="login"):(console.log("â„¹ï¸  Unknown route, using prop value:",g.initialView),x.value=g.initialView)};return Z(()=>g.initialView,A=>{console.log("ğŸ”„ Props initialView promijenjen:",A),x.value=A}),Z(()=>d.path,(A,P)=>{console.log("ğŸ”„ Ruta promijenjena:",P,"â†’",A),R()}),X(()=>{console.log("ğŸ¯ AuthManager mounted - inicijalni setup"),R(),setTimeout(()=>{console.log("ğŸ” Post-mount check:"),console.log("   - Final route:",d.path),console.log("   - Final view:",x.value),console.log("   - View matches route:",d.path==="/register"&&x.value==="register"||d.path==="/login"&&x.value==="login")},100)}),i({switchToLogin:w,switchToRegister:c,setView:A=>{["login","register"].includes(A)&&(x.value=A)}}),(A,P)=>(v(),b("div",null,[x.value==="login"?(v(),K(kt,{key:0,"is-logging-in":p.value,onLogin:S,onShowRegister:c,onGoHome:h,ref_key:"loginRef",ref:r},null,8,["is-logging-in"])):(v(),K(Tt,{key:1,"is-registering":p.value,onShowLogin:w,onGoHome:h,onRegistered:T},null,8,["is-registering"]))]))}},te=q(zt,[["__scopeId","data-v-8ef6db38"]]);const St={class:"fixed inset-0 bg-white bg-opacity-95 z-50 flex items-center justify-center transition-opacity duration-300"},Ct={class:"text-center"},Rt={class:"text-gray-700 font-semibold text-lg mb-2"},Ut={class:"text-gray-500 text-sm"},Lt={__name:"Loader",props:{message:{type:String,default:"UÄitavanje..."},subMessage:{type:String,default:"Prijavljujemo vas u sustav"}},setup(s){return(i,l)=>(v(),b("div",St,[e("div",Ct,[l[0]||(l[0]=e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"},null,-1)),e("p",Rt,f(s.message),1),e("p",Ut,f(s.subMessage),1),l[1]||(l[1]=e("div",{class:"flex justify-center space-x-1 mt-4"},[e("div",{class:"w-2 h-2 bg-blue-600 rounded-full animate-pulse",style:{"animation-delay":"0ms"}}),e("div",{class:"w-2 h-2 bg-blue-600 rounded-full animate-pulse",style:{"animation-delay":"200ms"}}),e("div",{class:"w-2 h-2 bg-blue-600 rounded-full animate-pulse",style:{"animation-delay":"400ms"}})],-1))])]))}},Et=q(Lt,[["__scopeId","data-v-f3ef97a9"]]),Mt={class:"max-w-6xl mx-auto p-6"},Dt={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Ot={class:"bg-white p-6 rounded-lg shadow-sm border"},Vt={class:"text-3xl font-bold text-blue-600"},It={class:"text-xs text-gray-500 mt-1 space-y-1"},Gt={class:"bg-white p-6 rounded-lg shadow-sm border"},Ft={class:"text-3xl font-bold text-green-600"},Ht={class:"text-xs text-gray-500 mt-1"},qt={class:"bg-white p-6 rounded-lg shadow-sm border"},Kt=["title"],Bt={class:"bg-white p-6 rounded-lg shadow-sm border"},Jt={key:0,class:"bg-white p-6 rounded-lg shadow-sm border mb-6"},Wt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Zt={class:"md:col-span-2"},Qt={class:"flex gap-2 mt-4"},Xt=["disabled"],Yt={key:0,class:"animate-spin"},es={key:1},ts={class:"bg-white rounded-lg shadow-sm border"},ss={class:"p-6 border-b"},os={class:"flex justify-between items-center"},as={class:"text-sm text-gray-600 space-y-1"},rs={class:"font-bold text-green-600"},ns={class:"text-xs"},is={class:"font-semibold"},ls={key:0,class:"p-6 text-center text-gray-500"},ds={key:1,class:"p-6 text-center text-gray-500"},us={class:"max-w-md mx-auto"},cs={key:2,class:"divide-y"},ms={class:"flex justify-between items-start"},ps={class:"flex-1"},gs={class:"flex items-center gap-3 mb-2"},vs={class:"font-semibold text-lg text-gray-800"},bs={class:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"},fs={class:"text-gray-600 flex items-center gap-2"},xs={class:"text-sm text-gray-500 flex items-center gap-2 mt-1"},hs={class:"text-xs text-gray-400 mt-2"},ys={class:"flex gap-2"},ks=["onClick","title","disabled"],ws={key:0,class:"flex items-center gap-1"},js=["onClick","disabled"],_s={key:0,class:"animate-spin"},$s={key:1},Ns={key:0,class:"mt-4 ml-4 p-4 bg-gray-50 rounded-lg border"},As={class:"font-semibold mb-3 flex items-center gap-2 text-gray-700"},Ps={class:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"},Ts={key:0,class:"text-center py-4"},zs={key:1,class:"text-gray-500 text-sm mb-3 p-4 bg-white rounded border text-center"},Ss={key:2,class:"space-y-3 mb-4"},Cs={class:"flex justify-between items-start gap-3"},Rs={class:"flex-1"},Us={class:"text-gray-800"},Ls={class:"text-xs text-gray-400 block mt-2"},Es=["onClick","disabled"],Ms={key:0,class:"animate-spin"},Ds={key:1},Os={key:3,class:"flex gap-2"},Vs=["onUpdate:modelValue","onKeyup","disabled"],Is=["onClick","disabled"],Gs={key:0,class:"animate-spin"},Fs={key:1},ce={__name:"Dashboard",setup(s){const i=$([]),l=O({}),o=O({}),d=O({}),g=O({}),u=O({}),x=$(!1),p=O({name:"",email:"",company:""}),r=O({clients:0,totalNotes:0,lastNote:"Nema biljeÅ¾ki"}),w=$(!0),c=$(null),h=$(null),S=$(!1),T=$(null),R=async a=>{console.log("ğŸ”„ Inicijaliziram loader za klijenta:",a),g[a]=!0,await we(),await new Promise(t=>setTimeout(t,300)),await A(a)},A=async a=>{if(l[a]){d[a]=!d[a],g[a]=!1;return}d[a]=!0,await P(a)},P=async a=>{var t,n;try{console.log("ğŸ“ UÄitavam biljeÅ¡ke za klijenta:",a),await new Promise(k=>setTimeout(k,1e3));const _=await z.get(`/clients/${a}/notes`);l[a]=_.data,console.log("âœ… BiljeÅ¡ke uÄitane:",l[a].length),o[a]&&(o[a].count=l[a].length)}catch(_){console.error("GreÅ¡ka pri uÄitavanju biljeÅ¡ki:",_),alert("GreÅ¡ka pri uÄitavanju biljeÅ¡ki: "+(((n=(t=_.response)==null?void 0:t.data)==null?void 0:n.error)||_.message))}finally{g[a]=!1}},y=async()=>{try{console.log("ğŸ“Š UÄitavam broj biljeÅ¡ki po klijentu...");const a=await z.get("/clients/notes-count");Object.keys(o).forEach(t=>delete o[t]),Object.assign(o,a.data),console.log("âœ… Broj biljeÅ¡ki po klijentu uÄitano:",o)}catch(a){console.error("GreÅ¡ka pri uÄitavanju broja biljeÅ¡ki:",a),m()}},m=()=>{console.log("ğŸ”„ Koristim fallback za brojanje biljeÅ¡ki..."),i.value.forEach(a=>{var t;o[a.id]||(o[a.id]={count:((t=l[a.id])==null?void 0:t.length)||0,name:a.name})})},j=async()=>{var a,t;try{w.value=!0,console.log("ğŸ“‹ UÄitavam klijente...");const n=await z.get("/clients");i.value=n.data,console.log("âœ… Klijenti uÄitani:",i.value.length),await I(),await y(),await U()}catch(n){console.error("GreÅ¡ka pri uÄitavanju klijenata:",n),alert("GreÅ¡ka pri uÄitavanju klijenata: "+(((t=(a=n.response)==null?void 0:a.data)==null?void 0:t.error)||n.message))}finally{w.value=!1}},I=async()=>{try{const t=(await z.get("/clients/stats")).data;console.log("ğŸ“Š Podaci s backenda:",t);const n={clients:t.totalClients||0,totalNotes:t.totalNotes||0,lastNote:"UÄitavam..."};Object.assign(r,n),console.log("âœ… Statistika adaptirana:",r)}catch(a){console.error("GreÅ¡ka pri uÄitavanju statistike:",a),r.clients=i.value.length,r.totalNotes=M(),r.lastNote=V()}},U=async()=>{try{if(console.log("ğŸ” TraÅ¾im zadnju biljeÅ¡ku iz postojeÄ‡ih podataka..."),r.totalNotes>0){console.log("ğŸ“ PokuÅ¡avam uÄitati sve biljeÅ¡ke za pronalaÅ¾enje zadnje...");try{const t=await z.get("/notes");if(t.data&&t.data.length>0){const n=t.data.reduce((_,k)=>{const G=new Date(k.created_at),ne=_?new Date(_.created_at):null;return!ne||G>ne?k:_},null);if(n){r.lastNote=n.content,console.log("âœ… Zadnja biljeÅ¡ka pronaÄ‘ena:",r.lastNote);return}}}catch{console.log("â„¹ï¸ Endpoint /notes nije dostupan, pokuÅ¡avam drugi naÄin...")}}const a=V();if(a!=="Nema biljeÅ¾ki"){r.lastNote=a,console.log("âœ… Zadnja biljeÅ¡ka pronaÄ‘ena iz clientNotes:",r.lastNote);return}r.lastNote="Nema biljeÅ¾ki",console.log("â„¹ï¸ Nema biljeÅ¾ki u sustavu")}catch(a){console.error("GreÅ¡ka pri pronalaÅ¾enju zadnje biljeÅ¡ke:",a),r.lastNote=V()}},M=()=>{if(r.totalNotes>0)return r.totalNotes;let a=0;return Object.values(o).forEach(t=>{a+=t.count||0}),a===0&&i.value.length>0&&Object.values(l).forEach(t=>{Array.isArray(t)&&(a+=t.length)}),a},V=()=>{let a=null,t=null;return Object.values(l).forEach(n=>{Array.isArray(n)&&n.forEach(_=>{if(_&&_.created_at){const k=new Date(_.created_at);(!t||k>t)&&(t=k,a=_.content)}})}),a||"Nema biljeÅ¾ki"},pe=async()=>{var a,t;if(!p.name||!p.email){alert("Ime i email su obavezni");return}try{S.value=!0,console.log("â• Kreiranje klijenta:",p);const n=await z.post("/clients",p);console.log("âœ… Klijent kreiran:",n.data),Object.assign(p,{name:"",email:"",company:""}),x.value=!1,await j()}catch(n){console.error("GreÅ¡ka pri kreiranju klijenta:",n),alert("GreÅ¡ka pri kreiranju klijenta: "+(((t=(a=n.response)==null?void 0:a.data)==null?void 0:t.error)||n.message))}finally{S.value=!1}},ge=()=>{x.value=!1,Object.assign(p,{name:"",email:"",company:""})},ve=async a=>{var n,_;const t=i.value.find(k=>k.id===a);if(confirm(`Jeste li sigurni da Å¾elite obrisati klijenta "${t.name}" i sve njegove biljeÅ¡ke?`))try{T.value=a,console.log("ğŸ—‘ï¸ Brisanje klijenta:",a),await z.delete(`/clients/${a}`),console.log("âœ… Klijent obrisan"),await j()}catch(k){console.error("GreÅ¡ka pri brisanju klijenata:",k),alert("GreÅ¡ka pri brisanju klijenata: "+(((_=(n=k.response)==null?void 0:n.data)==null?void 0:_.error)||k.message))}finally{T.value=null}},ae=async a=>{var t,n,_;if(!((t=u[a])!=null&&t.trim())){alert("Unesite tekst biljeÅ¡ke");return}try{h.value=a,console.log("â• Dodavanje biljeÅ¡ke za klijenta:",a,"SadrÅ¾aj:",u[a]),await z.post(`/clients/${a}/notes`,{content:u[a]}),u[a]="",await y(),d[a]&&await P(a),await I(),await U(),console.log("âœ… BiljeÅ¡ka dodana")}catch(k){console.error("GreÅ¡ka pri dodavanju biljeÅ¡ke:",k),alert("GreÅ¡ka pri dodavanju biljeÅ¡ke: "+(((_=(n=k.response)==null?void 0:n.data)==null?void 0:_.error)||k.message))}finally{h.value=null}},be=async(a,t)=>{var n,_,k;if(confirm("Jeste li sigurni da Å¾elite obrisati ovu biljeÅ¡ku?"))try{c.value=a,console.log("ğŸ—‘ï¸ Brisanje biljeÅ¡ke:",a),await z.delete(`/notes/${a}`),await y(),await P(t),await I(),await U(),console.log("âœ… BiljeÅ¡ka obrisana")}catch(G){console.error("GreÅ¡ka pri brisanju biljeÅ¡ke:",G),((n=G.response)==null?void 0:n.status)===404?alert("BiljeÅ¡ka nije pronaÄ‘ena. MoÅ¾da je veÄ‡ obrisana."):alert("GreÅ¡ka pri brisanju biljeÅ¡ke: "+(((k=(_=G.response)==null?void 0:_.data)==null?void 0:k.error)||G.message))}finally{c.value=null}},fe=()=>{if(i.value.length===0)return"0";let a=0;return i.value.forEach(t=>{Y(t.id)>0&&a++}),a.toString()},xe=()=>{if(i.value.length===0)return"0";let a=0;return i.value.forEach(t=>{Y(t.id)===0&&a++}),a.toString()},re=()=>r.totalNotes===0||r.clients===0?"0.00":(r.totalNotes/r.clients).toFixed(2),Y=a=>{var t,n;return((t=o[a])==null?void 0:t.count)||((n=l[a])==null?void 0:n.length)||0},ee=a=>{const t=Y(a);return t===1?"1 biljeÅ¡ka":t>=2&&t<=4?`${t} biljeÅ¡ke`:`${t} biljeÅ¡ki`};return X(()=>{j()}),(a,t)=>(v(),b("div",Mt,[e("div",Dt,[e("div",Ot,[t[5]||(t[5]=e("h3",{class:"text-lg font-semibold text-gray-700"},"Ukupno klijenata",-1)),e("p",Vt,f(r.clients),1),e("div",It,[e("div",null,"ğŸ“ S biljeÅ¡kama: "+f(fe()),1),e("div",null,"ğŸ“„ Bez biljeÅ¡ki: "+f(xe()),1)])]),e("div",Gt,[t[6]||(t[6]=e("h3",{class:"text-lg font-semibold text-gray-700"},"Ukupno biljeÅ¡ki",-1)),e("p",Ft,f(r.totalNotes),1),e("p",Ht," Prosjek: "+f(re())+" po klijentu ",1)]),e("div",qt,[t[7]||(t[7]=e("h3",{class:"text-lg font-semibold text-gray-700"},"Zadnja biljeÅ¡ka",-1)),e("p",{class:"text-sm text-gray-600 mt-1 truncate",title:r.lastNote},f(r.lastNote),9,Kt)]),e("div",Bt,[t[8]||(t[8]=e("h3",{class:"text-lg font-semibold text-gray-700"},"Akcije",-1)),e("button",{onClick:t[0]||(t[0]=n=>x.value=!0),class:"mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 w-full"}," + Novi klijent ")])]),x.value?(v(),b("div",Jt,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold mb-4"},"Novi klijent",-1)),e("div",Wt,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Ime klijenta *",-1)),L(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>p.name=n),placeholder:"Unesite ime klijenta",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full"},null,512),[[E,p.name]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email *",-1)),L(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>p.email=n),placeholder:"email@primjer.com",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full"},null,512),[[E,p.email]])]),e("div",Zt,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tvrtka",-1)),L(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>p.company=n),placeholder:"Naziv tvrtke (opcionalno)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full"},null,512),[[E,p.company]])])]),e("div",Qt,[e("button",{onClick:pe,class:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2",disabled:!p.name||!p.email||S.value},[S.value?(v(),b("span",Yt,"â³")):(v(),b("span",es,"ğŸ’¾")),N(" "+f(S.value?"Spremanje...":"Spremi"),1)],8,Xt),e("button",{onClick:ge,class:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 flex items-center gap-2"},[...t[12]||(t[12]=[e("span",null,"âŒ",-1),N(" OtkaÅ¾i ",-1)])])])])):D("",!0),e("div",ts,[e("div",ss,[e("div",os,[t[17]||(t[17]=e("h3",{class:"text-lg font-semibold"},"Klijenti",-1)),e("div",as,[e("div",null,[t[14]||(t[14]=N(" Ukupno biljeÅ¡ki: ",-1)),e("span",rs,f(r.totalNotes),1)]),e("div",ns,[t[15]||(t[15]=N(" Prosjek: ",-1)),e("span",is,f(re()),1),t[16]||(t[16]=N(" po klijentu ",-1))])])])]),w.value?(v(),b("div",ls,[...t[18]||(t[18]=[e("div",{class:"flex justify-center items-center gap-2"},[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),N(" UÄitavanje klijenata... ")],-1)])])):i.value.length===0?(v(),b("div",ds,[e("div",us,[t[19]||(t[19]=e("div",{class:"text-4xl mb-4"},"ğŸ“Š",-1)),t[20]||(t[20]=e("h3",{class:"text-lg font-semibold mb-2"},"Nema klijenata",-1)),t[21]||(t[21]=e("p",{class:"text-sm mb-4"},"Dodajte prvog klijenta kako biste poÄeli koristiti CRM sustav.",-1)),e("button",{onClick:t[4]||(t[4]=n=>x.value=!0),class:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700"}," + Dodaj prvog klijenta ")])])):(v(),b("ul",cs,[(v(!0),b(H,null,W(i.value,n=>{var _;return v(),b("li",{key:n.id,class:"p-6 hover:bg-gray-50 transition-colors duration-200"},[e("div",ms,[e("div",ps,[e("div",gs,[e("h4",vs,f(n.name),1),e("span",bs,f(ee(n.id)),1)]),e("p",fs,[t[22]||(t[22]=e("span",null,"ğŸ“§",-1)),N(" "+f(n.email),1)]),e("p",xs,[t[23]||(t[23]=e("span",null,"ğŸ¢",-1)),N(" "+f(n.company||"Nema podataka o tvrtki"),1)]),e("p",hs," Kreiran: "+f(new Date(n.created_at).toLocaleDateString("hr-HR")),1)]),e("div",ys,[e("button",{onClick:k=>R(n.id),class:"text-blue-600 hover:text-blue-800 px-3 py-2 rounded border border-blue-200 hover:bg-blue-50 transition-colors duration-200 flex items-center gap-2",title:d[n.id]?"Sakrij biljeÅ¡ke":"PrikaÅ¾i biljeÅ¡ke",disabled:g[n.id]},[e("span",null,f(d[n.id]?"ğŸ“•":"ğŸ“˜"),1),g[n.id]?(v(),b("div",ws,[...t[24]||(t[24]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"},null,-1),N(" UÄitavanje... ",-1)])])):(v(),b(H,{key:1},[N(f(d[n.id]?"Sakrij":"BiljeÅ¡ke")+" ("+f(ee(n.id))+") ",1)],64))],8,ks),e("button",{onClick:k=>ve(n.id),class:"text-red-600 hover:text-red-800 px-3 py-2 rounded border border-red-200 hover:bg-red-50 transition-colors duration-200 flex items-center gap-2",title:"ObriÅ¡i klijenta",disabled:T.value===n.id},[T.value===n.id?(v(),b("span",_s,"â³")):(v(),b("span",$s,"ğŸ—‘ï¸")),N(" "+f(T.value===n.id?"BriÅ¡e se...":"ObriÅ¡i"),1)],8,js)])]),d[n.id]?(v(),b("div",Ns,[e("h5",As,[t[25]||(t[25]=e("span",null,"ğŸ“",-1)),N(" BiljeÅ¡ke za "+f(n.name)+" ",1),e("span",Ps,f(ee(n.id)),1)]),g[n.id]?(v(),b("div",Ts,[...t[26]||(t[26]=[e("div",{class:"flex justify-center items-center gap-2 text-gray-500"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e("div",null,"UÄitavanje biljeÅ¡ki...")],-1)])])):((_=l[n.id])==null?void 0:_.length)===0?(v(),b("div",zs,[...t[27]||(t[27]=[e("div",{class:"text-2xl mb-2"},"ğŸ“„",-1),e("p",null,"Nema biljeÅ¾ki za ovog klijenta.",-1),e("p",{class:"text-xs mt-1"},"Dodajte prvu biljeÅ¡ku ispod.",-1)])])):(v(),b("ul",Ss,[(v(!0),b(H,null,W(l[n.id],k=>(v(),b("li",{key:k.id,class:"bg-white p-4 rounded border hover:shadow-sm transition-shadow duration-200"},[e("div",Cs,[e("div",Rs,[e("p",Us,f(k.content),1),e("span",Ls," ğŸ“… "+f(new Date(k.created_at).toLocaleString("hr-HR")),1)]),e("button",{onClick:G=>be(k.id,n.id),class:"text-red-500 hover:text-red-700 transition-colors duration-200 flex-shrink-0 p-1 rounded hover:bg-red-50",title:"ObriÅ¡i biljeÅ¡ku",disabled:c.value===k.id},[c.value===k.id?(v(),b("span",Ms,"â³")):(v(),b("span",Ds,"ğŸ—‘ï¸"))],8,Es)])]))),128))])),g[n.id]?D("",!0):(v(),b("div",Os,[L(e("input",{"onUpdate:modelValue":k=>u[n.id]=k,onKeyup:ke(k=>ae(n.id),["enter"]),placeholder:"Unesite novu biljeÅ¡ku...",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:h.value===n.id},null,40,Vs),[[E,u[n.id]]]),e("button",{onClick:k=>ae(n.id),class:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 text-sm flex items-center gap-2 transition-colors duration-200",disabled:!u[n.id]||h.value===n.id},[h.value===n.id?(v(),b("span",Gs,"â³")):(v(),b("span",Fs,"â•")),N(" "+f(h.value===n.id?"Dodaje se...":"Dodaj"),1)],8,Is)]))])):D("",!0)])}),128))]))])]))}};const Hs={class:"min-h-screen bg-gray-50"},qs={class:"container mx-auto px-4 py-8"},Ks={key:1,class:"fixed top-4 right-4 z-50 max-w-sm"},Bs={class:"flex items-center justify-between"},Js={class:"flex items-center"},Ws={class:"text-lg mr-2"},Zs={class:"font-medium"},Qs={__name:"App",setup(s){const i=Q(),l=se(),o=$(null),d=$(!0),g=$(!1),u=$("login"),x=$(""),p=$("success"),r=$("UÄitavanje..."),w=$("Prijavljujemo vas u sustav"),c=(m,j="success")=>{x.value=m,p.value=j,setTimeout(()=>{h()},5e3)},h=()=>{x.value="",p.value="success"},S=()=>{d.value=!1,u.value="login",i.push("/login").catch(()=>{})},T=()=>{d.value=!1,u.value="register",i.push("/register").catch(()=>{})},R=()=>{d.value=!0,u.value="login",i.push("/").catch(()=>{})},A=async m=>{console.log("ğŸ”„ Auth success handler pokrenut:",m),r.value="Provjeravam podatke...",w.value="Autenticiram vaÅ¡ raÄun",g.value=!0;try{await new Promise(j=>setTimeout(j,800)),C.setAuth(m.token,m.user),o.value=m.user,console.log("âœ… User postavljen u App.vue:",o.value),r.value="UspjeÅ¡no prijavljeni!",w.value=`DobrodoÅ¡li, ${m.user.firstName}!`,c(`DobrodoÅ¡li, ${m.user.firstName}!`,"success"),await new Promise(j=>setTimeout(j,1200)),console.log("âœ… Auth success zavrÅ¡eno, prebacujem na dashboard...")}catch(j){console.error("Auth success handling error:",j),c("GreÅ¡ka pri prijavi","error")}finally{g.value=!1,r.value="UÄitavanje...",w.value="Prijavljujemo vas u sustav"}},P=()=>{C.clearAuth(),o.value=null,c("UspjeÅ¡no ste se odjavili","success"),console.log("âœ… User logged out"),R()},y=()=>{if(console.log("ğŸ” Provjeram auth status..."),C.isAuthenticated()){const m=C.getUser();o.value=m,console.log("âœ… User restored from localStorage:",o.value),c(`DobrodoÅ¡li natrag, ${m.firstName}!`,"success")}else o.value=null,console.log("â„¹ï¸ Nema validnog auth tokena")};return Z(()=>l.path,m=>{console.log("ğŸ“ Route changed:",m),m==="/login"?(d.value=!1,u.value="login"):m==="/register"?(d.value=!1,u.value="register"):m==="/"&&(d.value=!0,u.value="login")},{immediate:!0}),X(()=>{console.log("ğŸš€ App.vue mounted"),y(),window.addEventListener("storage",m=>{m.key==="authToken"&&!m.newValue&&(console.log("ğŸ” Storage changed - logging out"),P())})}),je(()=>{window.removeEventListener("storage",P)}),(m,j)=>(v(),b("div",Hs,[g.value?(v(),K(Et,{key:0,message:r.value,"sub-message":w.value},null,8,["message","sub-message"])):D("",!0),ie(Ke,{user:o.value,onGoHome:R,onLogout:P},null,8,["user"]),e("main",qs,[ie($e,{name:"page-fade",mode:"out-in"},{default:_e(()=>[d.value&&!o.value&&!g.value?(v(),K(ue,{onGoToLogin:S,onGoToRegister:T,key:"homepage"})):!o.value&&!g.value?(v(),K(te,{"initial-view":u.value,onSuccess:A,onGoHome:R,key:"auth"},null,8,["initial-view"])):o.value&&!g.value?(v(),K(ce,{user:o.value,onLogout:P,key:"dashboard"},null,8,["user"])):D("",!0)]),_:1})]),x.value?(v(),b("div",Ks,[e("div",{class:B(["p-4 rounded-lg shadow-lg border transform transition-all duration-300",p.value==="error"?"bg-red-50 border-red-200 text-red-800":"bg-green-50 border-green-200 text-green-800"])},[e("div",Bs,[e("div",Js,[e("span",Ws,f(p.value==="error"?"âŒ":"âœ…"),1),e("span",Zs,f(x.value),1)]),e("button",{onClick:h,class:"ml-4 text-gray-500 hover:text-gray-700"}," âœ• ")])],2)])):D("",!0)]))}},Xs=q(Qs,[["__scopeId","data-v-162f3270"]]);const me=Ne({history:Ae(),routes:[{path:"/",name:"Home",component:ue},{path:"/login",name:"Login",component:te,props:{initialView:"login"}},{path:"/register",name:"Register",component:te,props:{initialView:"register"}},{path:"/dashboard",name:"Dashboard",component:ce,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}]});me.beforeEach((s,i,l)=>{console.log("ğŸ›¡ï¸ Route guard:",s.name);const o=C.isAuthenticated();console.log("ğŸ” Auth status:",o),s.meta.requiresAuth&&!o?(console.log("ğŸš« Access denied, redirecting to login"),l("/login")):l()});const oe=Pe(Xs);oe.use(Ce());oe.use(me);oe.mount("#app");
